# üìä –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ —Å–∏—Å—Ç–µ–º–µ –∏—Å—Ç–æ—Ä–∏–∏ —Ä–µ–≥–∏–æ–Ω–∞–ª—å–Ω—ã—Ö —Ü–µ–Ω

## üéØ –û–ø–∏—Å–∞–Ω–∏–µ

–°–∏—Å—Ç–µ–º–∞ –∏—Å—Ç–æ—Ä–∏–∏ —Ä–µ–≥–∏–æ–Ω–∞–ª—å–Ω—ã—Ö —Ü–µ–Ω –ø–æ–∑–≤–æ–ª—è–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ—Ö—Ä–∞–Ω—è—Ç—å –∏ –∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –æ —Ü–µ–Ω–∞—Ö –Ω–∞ —Ç–æ–ø–ª–∏–≤–æ –ø–æ —Ä–µ–≥–∏–æ–Ω–∞–º –†–æ—Å—Å–∏–∏ —Å –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–µ–π –ø–æ –¥–∞—Ç–∞–º. –≠—Ç–æ —Ä–µ—à–∞–µ—Ç –ø—Ä–æ–±–ª–µ–º—É –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π —Ü–µ–Ω –≤–æ –≤—Ä–µ–º–µ–Ω–∏ –±–µ–∑ —Ç–æ—á–Ω–æ–≥–æ –∑–Ω–∞–Ω–∏—è –≤—Ä–µ–º–µ–Ω–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∏—Å—Ç–æ—á–Ω–∏–∫–∞.

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö

```
data/
‚îî‚îÄ‚îÄ regional_history/
    ‚îú‚îÄ‚îÄ history_index.json          # –ò–Ω–¥–µ–∫—Å –≤—Å–µ—Ö –≤—ã–≥—Ä—É–∑–æ–∫
    ‚îú‚îÄ‚îÄ latest/                     # –ü–æ—Å–ª–µ–¥–Ω–∏–µ –¥–∞–Ω–Ω—ã–µ –ø–æ –¥–∞—Ç–∞–º
    ‚îÇ   ‚îú‚îÄ‚îÄ latest_regions_20250115.json
    ‚îÇ   ‚îú‚îÄ‚îÄ latest_regions_20250115.xlsx
    ‚îÇ   ‚îî‚îÄ‚îÄ latest_regions_20250115.csv
    ‚îî‚îÄ‚îÄ 2025/                       # –ê—Ä—Ö–∏–≤ –ø–æ –≥–æ–¥–∞–º
        ‚îî‚îÄ‚îÄ 01/                     # –ú–µ—Å—è—Ü—ã
            ‚îú‚îÄ‚îÄ 15/                 # –î–Ω–∏
            ‚îÇ   ‚îú‚îÄ‚îÄ all_regions_20250115_142830.json
            ‚îÇ   ‚îú‚îÄ‚îÄ all_regions_20250115_142830.xlsx
            ‚îÇ   ‚îú‚îÄ‚îÄ all_regions_20250115_142830.csv
            ‚îÇ   ‚îú‚îÄ‚îÄ regions_75of85_20250115_151245.json
            ‚îÇ   ‚îî‚îÄ‚îÄ ...
            ‚îî‚îÄ‚îÄ 16/
                ‚îî‚îÄ‚îÄ ...
```

## üöÄ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –û—Å–Ω–æ–≤–Ω–æ–π –ø–∞—Ä—Å–∏–Ω–≥ —Å –∏—Å—Ç–æ—Ä–∏–µ–π

```bash
# –ü–∞—Ä—Å–∏–Ω–≥ –≤—Å–µ—Ö —Ä–µ–≥–∏–æ–Ω–æ–≤ (–∏—Å—Ç–æ—Ä–∏—è –≤–∫–ª—é—á–µ–Ω–∞ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
python regional_parser.py --all-regions

# –ü–∞—Ä—Å–∏–Ω–≥ –ø–æ–ø—É–ª—è—Ä–Ω—ã—Ö —Ä–µ–≥–∏–æ–Ω–æ–≤
python regional_parser.py --popular-regions

# –û—Ç–∫–ª—é—á–∏—Ç—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ –∏—Å—Ç–æ—Ä–∏—é
python regional_parser.py --all-regions --disable-history
```

### –ê–Ω–∞–ª–∏–∑ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö

```bash
# –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Ü–µ–Ω –º–µ–∂–¥—É –¥–∞—Ç–∞–º–∏
python src/history_utils.py compare --date1 2025-01-15 --date2 2025-01-16

# –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Ç–æ–ø–ª–∏–≤–∞
python src/history_utils.py compare --date1 2025-01-15 --date2 2025-01-16 --fuel "–ê–ò-95"

# –ê–Ω–∞–ª–∏–∑ —Ç—Ä–µ–Ω–¥–æ–≤ –∑–∞ 7 –¥–Ω–µ–π
python src/history_utils.py trends --days 7 --fuel "–ê–ò-95"

# –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∑–∞ 30 –¥–Ω–µ–π
python src/history_utils.py stats --days 30
```

## üìà –ü—Ä–∏–º–µ—Ä—ã –∞–Ω–∞–ª–∏–∑–∞

### –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Ü–µ–Ω

```bash
$ python src/history_utils.py compare --date1 2025-01-15 --date2 2025-01-16

üìä –°–†–ê–í–ù–ï–ù–ò–ï –¶–ï–ù: 2025-01-15 ‚Üí 2025-01-16
======================================================================
–û–±—â–∏—Ö —Ä–µ–≥–∏–æ–Ω–æ–≤: 82

üõ¢Ô∏è  –ê–ò-95:
   –†–µ–≥–∏–æ–Ω–æ–≤ —Å –∏–∑–º–µ–Ω–µ–Ω–∏—è–º–∏: 15
   –°—Ä–µ–¥–Ω–µ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ: +0.12 —Ä—É–±.
   –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–æ—Å—Ç: +0.80 —Ä—É–±. (—Ä–µ–≥–∏–æ–Ω 77)
   –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ —Å–Ω–∏–∂–µ–Ω–∏–µ: -0.30 —Ä—É–±. (—Ä–µ–≥–∏–æ–Ω 50)
```

### –ê–Ω–∞–ª–∏–∑ —Ç—Ä–µ–Ω–¥–æ–≤

```bash
$ python src/history_utils.py trends --days 7 --fuel "–ê–ò-95"

üìà –¢–†–ï–ù–î –¶–ï–ù –ù–ê –ê–ò-95 –∑–∞ 7 –¥–Ω–µ–π
======================================================================
–û–±—â–∏–π —Ç—Ä–µ–Ω–¥: üìà –†–û–°–¢
–ò–∑–º–µ–Ω–µ–Ω–∏–µ: +0.45 —Ä—É–±. (+0.7%)

–°—Ä–µ–¥–Ω–∏–µ —Ü–µ–Ω—ã –ø–æ –¥–Ω—è–º:
  2025-01-10: 62.15 —Ä—É–±. (83 —Ä–µ–≥–∏–æ–Ω–æ–≤)
  2025-01-11: 62.22 —Ä—É–±. (85 —Ä–µ–≥–∏–æ–Ω–æ–≤)
  2025-01-12: 62.35 —Ä—É–±. (84 —Ä–µ–≥–∏–æ–Ω–æ–≤)
  ...
```

## üîß –ü—Ä–æ–≥—Ä–∞–º–º–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

```python
from src.regional_history_manager import RegionalHistoryManager
from src.history_utils import RegionalHistoryAnalyzer
from datetime import date

# –ú–µ–Ω–µ–¥–∂–µ—Ä –∏—Å—Ç–æ—Ä–∏–∏
history_manager = RegionalHistoryManager()

# –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö —Å –∏—Å—Ç–æ—Ä–∏–µ–π
history_result = history_manager.save_regional_data_with_history(results)

# –ê–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä –∏—Å—Ç–æ—Ä–∏–∏
analyzer = RegionalHistoryAnalyzer()

# –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –¥–∞—Ç
comparison = analyzer.compare_dates(
    date(2025, 1, 15), 
    date(2025, 1, 16), 
    fuel_type="–ê–ò-95"
)

# –ê–Ω–∞–ª–∏–∑ —Ç—Ä–µ–Ω–¥–æ–≤
trends = analyzer.find_price_trends(days=7, fuel_type="–ê–ò-95")

# –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
stats = analyzer.get_statistics_summary(days=30)
```

## üìã –¢–∏–ø—ã –≤—ã–≥—Ä—É–∑–æ–∫

–°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∫–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä—É–µ—Ç –≤—ã–≥—Ä—É–∑–∫–∏ –ø–æ –ø–æ–ª–Ω–æ—Ç–µ:

- **–ü–û–õ–ù–ê–Ø** (‚â•80 —Ä–µ–≥–∏–æ–Ω–æ–≤): –ü–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∫–∞—Ä—Ç –∏ –ø–æ–ª–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞
- **–ö–†–£–ü–ù–ê–Ø** (60-79 —Ä–µ–≥–∏–æ–Ω–æ–≤): –î–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–ª—è –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–∞ –∞–Ω–∞–ª–∏–∑–æ–≤
- **–ß–ê–°–¢–ò–ß–ù–ê–Ø** (<60 —Ä–µ–≥–∏–æ–Ω–æ–≤): –û–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–π –∞–Ω–∞–ª–∏–∑

## üóÇÔ∏è –ò–º–µ–Ω–æ–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–æ–≤

```
all_regions_20250115_142830.json           # –ü–æ–ª–Ω–∞—è –≤—ã–≥—Ä—É–∑–∫–∞
regions_75of85_20250115_151245.json        # –ö—Ä—É–ø–Ω–∞—è –≤—ã–≥—Ä—É–∑–∫–∞ (75 –∏–∑ 85)
regions_partial_35reg_20250115_161000.json # –ß–∞—Å—Ç–∏—á–Ω–∞—è –≤—ã–≥—Ä—É–∑–∫–∞ (35 —Ä–µ–≥–∏–æ–Ω–æ–≤)
```

## üîç –ò–Ω–¥–µ–∫—Å –∏—Å—Ç–æ—Ä–∏–∏

–§–∞–π–ª `history_index.json` —Å–æ–¥–µ—Ä–∂–∏—Ç –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –≤—Å–µ—Ö –≤—ã–≥—Ä—É–∑–æ–∫:

```json
{
  "created": "2025-01-15T14:28:30",
  "last_updated": "2025-01-16T15:12:45",
  "total_entries": 156,
  "entries": [
    {
      "timestamp": "2025-01-15T14:28:30",
      "date": "20250115",
      "time": "142830",
      "completeness": "–ü–û–õ–ù–ê–Ø",
      "total_regions": 85,
      "successful_regions": 83,
      "failed_regions": 2,
      "prefix": "all_regions",
      "files": {
        "json": "2025/01/15/all_regions_20250115_142830.json",
        "excel": "2025/01/15/all_regions_20250115_142830.xlsx",
        "csv": "2025/01/15/all_regions_20250115_142830.csv"
      },
      "fuel_types": ["–ê–ò-92", "–ê–ò-95", "–ê–ò-98", "–î–¢", "–ì–∞–∑", "–ü—Ä–æ–ø–∞–Ω"],
      "price_statistics": {
        "–ê–ò-95": {
          "avg": 62.34,
          "min": 55.20,
          "max": 72.80,
          "count": 83
        }
      }
    }
  ]
}
```

## üßπ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã–º–∏

### –û—á–∏—Å—Ç–∫–∞ —Å—Ç–∞—Ä—ã—Ö –¥–∞–Ω–Ω—ã—Ö

```python
# –£–¥–∞–ª–∏—Ç—å –¥–∞–Ω–Ω—ã–µ —Å—Ç–∞—Ä—à–µ 90 –¥–Ω–µ–π
history_manager = RegionalHistoryManager()
history_manager.cleanup_old_data(keep_days=90)
```

### –ü–æ–∏—Å–∫ –¥–∞–Ω–Ω—ã—Ö –ø–æ –¥–∞—Ç–µ

```python
from datetime import date

# –ù–∞–π—Ç–∏ –≤—Å–µ –≤—ã–≥—Ä—É–∑–∫–∏ –∑–∞ –¥–∞—Ç—É
entries = history_manager.find_by_date(date(2025, 1, 15))

# –ü–æ–ª—É—á–∏—Ç—å –ø–æ—Å–ª–µ–¥–Ω—é—é –≤—ã–≥—Ä—É–∑–∫—É –∑–∞ –¥–∞—Ç—É
latest = history_manager.get_latest_by_date(date(2025, 1, 15))
```

## üéõÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏

–°–∏—Å—Ç–µ–º–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å–ª–µ–¥—É—é—â–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é:

- **–ë–∞–∑–æ–≤–∞—è –ø–∞–ø–∫–∞**: `data/`
- **–ü–∞–ø–∫–∞ –∏—Å—Ç–æ—Ä–∏–∏**: `data/regional_history/`
- **–ú–∞–∫—Å–∏–º—É–º –∑–∞–ø–∏—Å–µ–π –≤ –∏–Ω–¥–µ–∫—Å–µ**: 1000
- **–ê–≤—Ç–æ–æ—á–∏—Å—Ç–∫–∞**: –û—Ç–∫–ª—é—á–µ–Ω–∞ (–Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è –≤—Ä—É—á–Ω—É—é)

## üîÑ –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å

- ‚úÖ **–û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å**: –°—Ç–∞—Ä—ã–µ —Ñ–∞–π–ª—ã –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–¥–æ–ª–∂–∞—é—Ç —Å–æ–∑–¥–∞–≤–∞—Ç—å—Å—è
- ‚úÖ **–ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ**: –î–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –∏ –≤ –∏—Å—Ç–æ—Ä–∏—é, –∏ –≤ –∫–æ—Ä–µ–Ω—å
- ‚úÖ **–û—Ç–∫–ª—é—á–∞–µ–º–æ—Å—Ç—å**: –ò—Å—Ç–æ—Ä–∏—é –º–æ–∂–Ω–æ –æ—Ç–∫–ª—é—á–∏—Ç—å —Ñ–ª–∞–≥–æ–º `--disable-history`

## üö® –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### –û—à–∏–±–∫–∞ –∏–º–ø–æ—Ä—Ç–∞ pandas

```bash
pip install pandas openpyxl
```

### –ù–µ—Ç –ø—Ä–∞–≤ –Ω–∞ —Å–æ–∑–¥–∞–Ω–∏–µ –ø–∞–ø–æ–∫

–£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ —É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –µ—Å—Ç—å –ø—Ä–∞–≤–∞ –Ω–∞ –∑–∞–ø–∏—Å—å –≤ –ø–∞–ø–∫—É `data/`

### –ë–æ–ª—å—à–æ–π —Ä–∞–∑–º–µ—Ä –∏—Å—Ç–æ—Ä–∏–∏

–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫—É—é –æ—á–∏—Å—Ç–∫—É:

```python
history_manager.cleanup_old_data(keep_days=60)  # –û—Å—Ç–∞–≤–∏—Ç—å 60 –¥–Ω–µ–π
```

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–î–ª—è –≤–æ–ø—Ä–æ—Å–æ–≤ –∏ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π –ø–æ —Å–∏—Å—Ç–µ–º–µ –∏—Å—Ç–æ—Ä–∏–∏:

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø–∞—Ä—Å–µ—Ä–∞
2. –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ –ø–∞–ø–∫–∏ —Å–æ–∑–¥–∞–ª–∏—Å—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ñ–∞–π–ª –∏–Ω–¥–µ–∫—Å–∞ `history_index.json`
4. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–æ–º–∞–Ω–¥—ã –∞–Ω–∞–ª–∏–∑–∞ –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏

---

*–°–∏—Å—Ç–µ–º–∞ –∏—Å—Ç–æ—Ä–∏–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä—É –ø–∞–ø–æ–∫ –∏ —Ñ–∞–π–ª–æ–≤ –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ.*